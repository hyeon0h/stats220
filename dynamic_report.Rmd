---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)
library(tidyverse)
```

```{css}
@import url('https://fonts.googleapis.com/css2?family=Winky+Sans:ital,wght@0,300..900;1,300..900&display=swap');

@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&family=Winky+Sans:ital,wght@1,800&display=swap');

h1  {
  color: #486A27;
  font-family: "Winky Sans", sans-serif;
  font-weight: 800;
  font-style: italic;
  font-size: 40px;
}

h2 {
  color: #7C9AD3;
  font-family: "Winky Sans", sans-serif;
  font-weight: 600;
  font-style: italic;
  font-size: 30px;
}

body {
  color: black;
  font-family: "Quicksand", sans-serif;
  font-weight: 400;
  font-style: normal;
  font-size: 15px;
}
```


## Music Listening Trends

 This report shows insights into people's music listening habits based on the responses to my survey.
 
 The main things I focused on are:
 
 - *Daily Music Listening Time Distribution*.
 - *Popularity of Different Music Genres*.
 - *Most Preferred Music Genres*.
 

```{r data}
# Read data directly from the URL into logged_data
logged_data <- 
  read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vS4TrCuEYzZOF2AOezbqeyKbJcDjsV_UYuGDRWR3HNTqFwZqzqgcmnHjwtbA-QPAQmKVsq-RXhsLfDV/pub?gid=769878342&single=true&output=csv")


# Rename the variables in logged_data and create latest_data
latest_data <- logged_data %>% 
  rename(
    age = 2,
    gender = 3,
    hours = 4,
    device = 5,
    platforms = 6,
    genres= 7,
    favourite_genre = 8
    ) %>%
  select(age, gender, hours, device, platforms, genres, favourite_genre)
```



### The number of people listening to music for different durations each day.
```{r barchart1}
# Bar charts (average hours)
ggplot(latest_data, aes(x = hours)) +
  geom_bar(fill = "#5B85D3") +
  labs(title = "Daily Music Listening Time Distribution",
       x = "Hours",
       y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(hjust = 1)) 
```


### Total mentions of each genre from the survey.
```{r barchart2}
# Bar charts (music genres)
pop <- sum(str_count(latest_data$genres, "Pop"))
hiphop <- sum(str_count(latest_data$genres, "Hip-hop"))
rb <- sum(str_count(latest_data$genres, "R&B"))
jazz <- sum(str_count(latest_data$genres, "Jazz"))
rock <- sum(str_count(latest_data$genres, "Rock"))
country <- sum(str_count(latest_data$genres, "Country"))
electronic <- sum(str_count(latest_data$genres, "Electronic"))
indie <- sum(str_count(latest_data$genres, "Indie"))
classical <- sum(str_count(latest_data$genres, "Classical"))
instrumental <- sum(str_count(latest_data$genres, "Instrumental"))
religious_cultural <- sum(str_count(latest_data$genres, "Religious / Cultural"))
other <- sum(str_count(latest_data$genres, "Other"))

music_genres <- 
  data.frame(music_genres = 
               c("Pop", "Hip-hop", "R&B", "Jazz", "Rock", "Country", 
                 "Electronic", "Indie", "Classical", "Instrumental", 
                 "Religious / Cultural", "Other"), 
             people_count = 
               c(pop, hiphop, rb, jazz, rock, country, electronic, indie, 
                 classical, instrumental, religious_cultural, other))


ggplot(music_genres, aes(x = reorder(music_genres, -people_count), y = people_count)) + 
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(
    title = "Popularity of Different Music Genres",
    x = "Music Genres",
    y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```



### Each respondent's single most favorite genre from the survey.
```{r barchart3}
# Bar charts (favourite music genres)
ggplot(latest_data, aes(x = favourite_genre)) +
  geom_bar(fill = "#4471C6") +
  labs(title = "Most Preferred Music Genres",
       x = "Favourite Genres",
       y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```


### Summary Values
```{r summaries}
# Summary values (average hours)
avg_hours <- round(mean(latest_data$hours), 1)

# Summary values (most used device)
most_used_device <-
  names(which.max(table(latest_data$device)))

# Summary values (most mentioned genre)
most_mentioned <- 
  music_genres$music_genres[which.max(music_genres$people_count)]

# Summary values (Most Frequently Chosen Favorite Genre)
most_freq_favavourite <- 
  names(which.max(table(latest_data$favourite_genre)))


# Dynamic Comments
comment1 <- paste("On average, respondents listen to music for", avg_hours, "hours per day.")
comment2 <- paste0("The most common device used to listen to music is ", most_used_device, ".")
comment3 <- paste0("The genre that was mentioned the most is ", most_mentioned, ", indicating it is the most popular genre overall.")
comment4 <- paste0("For the single favorite genre question, the most frequently chosen one was ", most_freq_favavourite, ".")
```


- I collected responses from `r nrow(latest_data)` participants.
- `r comment1`
- `r comment2`
- Respondents could select multiple genres they listen to, and choose one favourite genre.
`r comment3`
`r comment4`

